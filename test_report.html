
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArtifactSleuth Forensic Report</title>
    <style>
        :root {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-card: #1f2937;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #374151;
        }
        
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent: #2563eb;
            --accent-hover: #1d4ed8;
            --border: #e2e8f0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        h1 {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .header-meta {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .theme-toggle, .copy-btn, .view-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        
        .theme-toggle:hover, .copy-btn:hover, .view-btn:hover {
            background: var(--accent);
            color: white;
        }
        
        .copy-btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }
        
        .copy-btn.copied {
            background: var(--success);
            color: white;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.25rem;
        }
        
        .summary-card h3 {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .summary-card .value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .summary-card.danger .value { color: var(--danger); }
        .summary-card.warning .value { color: var(--warning); }
        .summary-card.success .value { color: var(--success); }
        
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .section-header {
            background: var(--bg-secondary);
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .section-header h2 {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .section-header .badge {
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .section-content {
            padding: 1rem;
        }
        
        .section-content.collapsed {
            display: none;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        
        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        th {
            background: var(--bg-secondary);
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }
        
        tr:hover {
            background: var(--bg-secondary);
        }
        
        .risk-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .risk-high { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .risk-medium { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .risk-low { background: rgba(34, 197, 94, 0.2); color: var(--success); }
        .risk-none { background: rgba(148, 163, 184, 0.2); color: var(--text-secondary); }
        
        .hash-cell {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.75rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }
        
        .mime-cell {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        td {
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .hash-text {
            display: inline;
            text-overflow: ellipsis;
        }
        
        .vt-link {
            color: var(--accent);
            text-decoration: none;
        }
        
        .vt-link:hover {
            text-decoration: underline;
        }
        
        .tag {
            display: inline-block;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 0.125rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin: 0.125rem;
        }
        
        .tag.suspicious {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--danger);
            color: var(--danger);
        }
        
        .tag.network {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .tag.mismatch {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--warning);
            color: var(--warning);
        }
        
        .tag.info {
            background: rgba(34, 197, 94, 0.1);
            border-color: var(--success);
            color: var(--success);
        }
        
        .expandable {
            cursor: pointer;
        }
        
        .expandable-content {
            display: none;
            padding: 1rem;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
        }
        
        .expandable-content.show {
            display: block;
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        .detail-item {
            margin-bottom: 0.5rem;
        }
        
        .detail-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }
        
        .detail-value {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.875rem;
            word-break: break-all;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .detail-value-text {
            display: inline-block;
            font-family: inherit;
            font-size: inherit;
        }
        
        .ioc-section {
            margin-top: 1rem;
        }
        
        .ioc-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .password-protected {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning);
            color: var(--warning);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .error-list {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            padding: 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        
        .error-list li {
            color: var(--danger);
            margin-left: 1.5rem;
        }
        
        .filter-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .filter-bar input, .filter-bar select {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        
        .filter-bar input {
            flex: 1;
            min-width: 200px;
        }
        
        .metadata-section {
            background: var(--bg-secondary);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .metadata-section h4 {
            font-size: 0.875rem;
            margin-bottom: 0.75rem;
            color: var(--text-secondary);
        }
        
        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            .summary-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>üîç ArtifactSleuth Forensic Report</h1>
                <div class="header-meta">
                    Generated: 2026-01-26 16:49:18 | Scanned: C:\Code\ArtifactSleuth\test_data
                </div>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">
                üåì Toggle Theme
            </button>
        </header>
        
        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card">
                <h3>Total Files</h3>
                <div class="value">9</div>
            </div>
            <div class="summary-card">
                <h3>Total Size</h3>
                <div class="value">892.4 KB</div>
            </div>
            <div class="summary-card danger">
                <h3>High Risk</h3>
                <div class="value">0</div>
            </div>
            <div class="summary-card warning">
                <h3>Medium Risk</h3>
                <div class="value">0</div>
            </div>
            <div class="summary-card success">
                <h3>Low Risk</h3>
                <div class="value">2</div>
            </div>
            <div class="summary-card">
                <h3>Errors</h3>
                <div class="value">0</div>
            </div>
        </div>
        
        
        
        <!-- All Files (Optimized for 100k+ files) -->
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h2>üìÅ All Files</h2>
                <span class="badge">9</span>
            </div>
            <div class="section-content">
                <div class="filter-bar" style="gap: 0.75rem; flex-wrap: wrap;">
                    <input type="text" id="searchInput" placeholder="Search path, mime, hash..." style="min-width: 250px;">
                    <select id="riskFilter">
                        <option value="">All Risk Levels</option>
                        <option value="high">High Risk (50+)</option>
                        <option value="medium">Medium Risk (25-49)</option>
                        <option value="low">Low Risk (1-24)</option>
                        <option value="none">No Risk (0)</option>
                    </select>
                    <select id="pageSize">
                        <option value="100">100 / page</option>
                        <option value="250" selected>250 / page</option>
                        <option value="500">500 / page</option>
                        <option value="1000">1000 / page</option>
                    </select>
                    <span id="resultStats" style="color: var(--text-secondary); font-size: 0.875rem;">Loading...</span>
                </div>
                <table id="filesTable">
                    <thead>
                        <tr>
                            <th style="min-width: 300px;">Path</th>
                            <th>Size</th>
                            <th>MIME</th>
                            <th>Risk</th>
                            <th>SHA256</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="filesBody"></tbody>
                </table>
                <div class="filter-bar" style="margin-top: 1rem; justify-content: space-between;">
                    <span id="pageInfo" style="color: var(--text-secondary); font-size: 0.875rem;"></span>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="view-btn" onclick="prevPage()">‚óÄ Prev</button>
                        <button class="view-btn" onclick="nextPage()">Next ‚ñ∂</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Detail Panel (modal-style) -->
        <div id="detailPanel" style="display:none; position:fixed; top:0; right:0; width:550px; height:100vh; background:var(--bg-card); border-left:1px solid var(--border); overflow-y:auto; z-index:1000; padding:1.5rem; box-shadow: -2px 0 10px rgba(0,0,0,0.1);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                <h3 style="margin:0;">File Details</h3>
                <button class="view-btn" onclick="closeDetails()">‚úï Close</button>
            </div>
            <div id="detailBody"></div>
        </div>
        
        <!-- High Risk Files -->
        
        
        
        <!-- IOC Summary -->
        
        
        
        
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        
            
            
                
                    
                
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        
        
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h2>üåê Network Indicators (IOCs)</h2>
                <span class="badge">14</span>
            </div>
            <div class="section-content collapsed">
                <div style="display:flex;gap:1rem;margin-bottom:1rem;align-items:center;flex-wrap:wrap;">
                    <input type="text" id="iocSearch" placeholder="Filter IOCs..." style="flex:1;min-width:200px;padding:0.5rem;border:1px solid var(--border);border-radius:4px;background:var(--bg);color:var(--text);">
                    <select id="iocTypeFilter" style="padding:0.5rem;border:1px solid var(--border);border-radius:4px;background:var(--bg);color:var(--text);">
                        <option value="all">All Types</option>
                        <option value="domain">Domains</option>
                        <option value="ip">IP Addresses</option>
                    </select>
                    <span id="iocStats" style="color:var(--text-muted);font-size:0.9rem;"></span>
                </div>
                <table id="iocTable">
                    <thead>
                        <tr>
                            <th style="width:100px;">Type</th>
                            <th>Value</th>
                            <th>Source File</th>
                        </tr>
                    </thead>
                    <tbody id="iocBody"></tbody>
                </table>
                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:1rem;">
                    <button class="view-btn" onclick="iocPrevPage()">‚Üê Previous</button>
                    <span id="iocPageInfo" style="color:var(--text-muted);"></span>
                    <button class="view-btn" onclick="iocNextPage()">Next ‚Üí</button>
                </div>
            </div>
        </div>
        
        
        <!-- Errors -->
        
        
        <!-- File Type Breakdown -->
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h2>üìä File Type Breakdown</h2>
            </div>
            <div class="section-content collapsed">
                <table>
                    <thead>
                        <tr>
                            <th>Extension</th>
                            <th>Count</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                        <tr>
                            <td>.txt</td>
                            <td>2</td>
                        </tr>
                        
                        <tr>
                            <td>.exe</td>
                            <td>2</td>
                        </tr>
                        
                        <tr>
                            <td>.zip</td>
                            <td>1</td>
                        </tr>
                        
                        <tr>
                            <td>.pdf</td>
                            <td>1</td>
                        </tr>
                        
                        <tr>
                            <td>.ini</td>
                            <td>1</td>
                        </tr>
                        
                        <tr>
                            <td>.chm</td>
                            <td>1</td>
                        </tr>
                        
                        <tr>
                            <td>.md</td>
                            <td>1</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script id="file-data" type="application/json">[{"path": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74\\tftpd64.exe", "name": "tftpd64.exe", "relative_path": "tftpd64_portable_v4.74\\tftpd64.exe", "size": 439376, "size_human": "429.1 KB", "created_time": "2026-01-23T20:52:20.858000", "modified_time": "2025-10-14T18:34:59.674000", "accessed_time": "2026-01-26T16:49:04.907000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "application/x-dosexec", "file_type": "PE32+ executable (GUI) x86-64, for MS Windows", "friendly_type": "Application", "permissions": "-rwxrwxrwx", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": "00e1bc2fed3e8be6da0e1ca62b4c9b7a", "sha1": "6874d7b0925255ed9e99c927be0436a76644be2f", "sha256": "43a8a79001510fa969ae31521aef550ff4c9c7771e903792b60a499ecf48b388", "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": ["ccsca2021.crl.certum.pl", "crl.certum.pl", "github.com", "jounin.net", "repository.certum.pl", "subca.crl.certum.pl", "subca.repository.certum.pl", "tftpd64.com", "www.certum.pl", "www.tftpd64.com"], "exe_ips": ["1.2.3.4", "4.5.6.7", "4.74.0.0"], "exe_urls": ["http://ccsca2021.crl.certum.pl/ccsca2021.crl0s", "http://ccsca2021.ocsp-certum.com05", "http://crl.certum.pl/ctnca.crl0k", "http://crl.certum.pl/ctnca2.crl0l", "http://repository.certum.pl/ccsca2021.cer0", "http://repository.certum.pl/ctnca.cer09", "http://repository.certum.pl/ctnca2.cer09", "http://subca.crl.certum.pl/ctsca2021.crl0", "http://subca.ocsp-certum.com0", "http://subca.ocsp-certum.com01", "http://subca.ocsp-certum.com02", "http://subca.repository.certum.pl/ctsca2021.cer0(", "http://www.certum.pl/CPS0", "https://github.com/PJO2/tftpd64", "https://tftpd64.com,", "https://www.certum.pl/CPS0", "https://www.tftpd64.com"], "exe_suspicious_imports": ["WSAStartup: Network initialization", "socket: Socket creation", "connect: Network connection", "recv: Network receive", "send: Network send", "VirtualProtect: Memory protection changes", "CreateFileA: File access", "DeleteFileA: File deletion", "GetProcAddress: Dynamic function resolution", "IsDebuggerPresent: Debugger detection", "CreateFileW: File access", "RegDeleteKeyA: Registry deletion", "RegSetValueExA: Registry modification", "RegOpenKeyExA: Registry access"], "exe_analysis_error": null, "signature_info": {"is_signed": false, "subject": null, "issuer": null, "status": null, "has_signature_directory": true}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 21, "risk_reasons": ["Suspicious imports: 14 (unsigned)", "Network indicators: 10 domains, 3 IPs", "Executable file: .exe"]}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\xcopy.exe", "name": "xcopy.exe", "relative_path": "xcopy.exe", "size": 73728, "size_human": "72.0 KB", "created_time": "2026-01-23T20:59:45.629000", "modified_time": "2024-04-01T10:22:16.591000", "accessed_time": "2026-01-26T16:49:04.479000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "application/x-dosexec", "file_type": "PE32+ executable (console) x86-64, for MS Windows", "friendly_type": "Application", "permissions": "-rwxrwxrwx", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": "2e3735ce788ac354393e7d754174e6d5", "sha1": "5d2a2636912afcb3e92721133adfff981af61af2", "sha256": "96e01cdc713a4306abb3b58aef982d67a209dddadc8cff5c4c77a5595f712828", "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": ["5.1.0.0"], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {"is_signed": false, "subject": null, "issuer": null, "status": null, "has_signature_directory": false}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 3, "risk_reasons": ["Executable file: .exe"]}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\archive.zip", "name": "archive.zip", "relative_path": "archive.zip", "size": 137, "size_human": "137.0 B", "created_time": "2026-01-23T13:23:02.408000", "modified_time": "2026-01-23T13:23:02.469000", "accessed_time": "2026-01-26T16:49:04.438000", "is_directory": false, "is_archive": true, "is_password_protected": false, "archive_path": null, "mime_type": "application/zip", "file_type": "Zip archive data, at least v2.0 to extract", "friendly_type": "zip Archive", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": null, "sha1": null, "sha256": null, "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\test.txt", "name": "test.txt", "relative_path": "test.txt", "size": 23, "size_human": "23.0 B", "created_time": "2026-01-23T13:22:53.501000", "modified_time": "2026-01-23T13:22:53.505000", "accessed_time": "2026-01-26T16:49:04.427000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "text/plain", "file_type": "ASCII text, with CRLF line terminators", "friendly_type": ".TXT File", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": null, "sha1": null, "sha256": null, "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74\\EUPL-EN.pdf", "name": "EUPL-EN.pdf", "relative_path": "tftpd64_portable_v4.74\\EUPL-EN.pdf", "size": 34312, "size_human": "33.5 KB", "created_time": "2026-01-23T20:52:20.809000", "modified_time": "2025-06-24T12:40:59.741000", "accessed_time": "2026-01-26T16:49:04.446000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "application/pdf", "file_type": "PDF document, version 1.4", "friendly_type": ".PDF File", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": "254b5ddbc15269e72ba3a0508681a70c", "sha1": "2263ae4c0b71bf7be09707d8ffe1176807e8c69e", "sha256": "cd5d9e2a925d8daa92d083fd8c1cea48df1bcfffd857f4f93e2148fddc5001ec", "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": false, "doc_has_javascript": false, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74\\tftpd32.ini", "name": "tftpd32.ini", "relative_path": "tftpd64_portable_v4.74\\tftpd32.ini", "size": 1463, "size_human": "1.4 KB", "created_time": "2026-01-23T20:52:20.849000", "modified_time": "2026-01-14T09:14:27.602000", "accessed_time": "2026-01-26T16:49:04.431000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "text/plain", "file_type": "ASCII text, with CRLF line terminators", "friendly_type": ".INI File", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": null, "sha1": null, "sha256": null, "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74\\tftpd32.chm", "name": "tftpd32.chm", "relative_path": "tftpd64_portable_v4.74\\tftpd32.chm", "size": 364722, "size_human": "356.2 KB", "created_time": "2026-01-23T20:52:20.828000", "modified_time": "2025-06-24T10:13:27.018000", "accessed_time": "2026-01-26T16:49:04.432000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "application/octet-stream", "file_type": "MS Windows HtmlHelp Data", "friendly_type": "Compiled HTML Help file", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data\\tftpd64_portable_v4.74", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": "de0095e371874836fb50cd3400d7b204", "sha1": "8a1000443a71417c6233f277b87ca6585bebca2a", "sha256": "810a0f52703d051b30d5ecd219c72b0599964de34d1c1912367271c87d4725bf", "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "C:\\Code\\ArtifactSleuth\\test_data\\readme.md", "name": "readme.md", "relative_path": "readme.md", "size": 14, "size_human": "14.0 B", "created_time": "2026-01-23T13:22:53.505000", "modified_time": "2026-01-23T13:22:53.505000", "accessed_time": "2026-01-26T16:49:04.430000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": null, "mime_type": "text/plain", "file_type": "ASCII text, with CRLF line terminators", "friendly_type": ".MD File", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "C:\\Code\\ArtifactSleuth\\test_data", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": null, "sha1": null, "sha256": null, "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}, {"path": "archive.zip/test.txt", "name": "test.txt", "relative_path": "archive.zip/test.txt", "size": 23, "size_human": "23.0 B", "created_time": "2026-01-26T16:49:17.734000", "modified_time": "2026-01-26T16:49:17.735000", "accessed_time": "2026-01-26T16:49:17.735000", "is_directory": false, "is_archive": false, "is_password_protected": false, "archive_path": "archive.zip", "mime_type": "text/plain", "file_type": "ASCII text, with CRLF line terminators", "friendly_type": ".TXT File", "permissions": "-rw-rw-rw-", "owner": "NOTBADLEN\\maitn", "attributes": "A", "computer": "NotBadLEN", "parent_folder": "archive.zip", "extension_mismatch": false, "expected_extensions": null, "doc_author": null, "doc_last_modified_by": null, "doc_title": null, "doc_subject": null, "doc_keywords": null, "doc_created": null, "doc_modified": null, "doc_company": null, "doc_manager": null, "doc_category": null, "doc_comments": null, "md5": "475918671ac7a4ad2c1c8460a7f29197", "sha1": "d365bb2673496f08444cdb5de75f46e5eaa15c41", "sha256": "19ff0df18e4adfca33ee0a9573155346f36d3f7d36341ea6d1911dd4ca696624", "vt_detected": null, "vt_detection_ratio": null, "vt_link": null, "vt_error": null, "doc_has_macros": null, "doc_has_javascript": null, "doc_suspicious_elements": [], "doc_analysis_error": null, "exe_domains": [], "exe_ips": [], "exe_urls": [], "exe_suspicious_imports": [], "exe_analysis_error": null, "signature_info": {}, "exe_company": null, "exe_product": null, "exe_description": null, "exe_version": null, "is_signed": false, "sig_subject": null, "sig_issuer": null, "defender_scanned": null, "defender_detected": null, "defender_threat_name": null, "defender_error": null, "risk_score": 0, "risk_reasons": []}]</script>
    <script>
        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            html.setAttribute('data-theme', currentTheme === 'dark' ? 'light' : 'dark');
            localStorage.setItem('theme', html.getAttribute('data-theme'));
        }
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
        
        function toggleSection(header) {
            const content = header.nextElementSibling;
            content.classList.toggle('collapsed');
        }
        
        function copyHash(hash, button) {
            navigator.clipboard.writeText(hash).then(() => {
                button.textContent = '‚úì';
                button.classList.add('copied');
                setTimeout(() => { button.textContent = 'üìã'; button.classList.remove('copied'); }, 1500);
            });
        }
        
        // Optimized data handling for 100k+ files
        const filesData = JSON.parse(document.getElementById('file-data').textContent || '[]');
        let filtered = filesData;
        let page = 1;
        let pageSize = 250;
        let debounceTimer = null;
        
        function formatSize(bytes) {
            if (!bytes || isNaN(bytes)) return '-';
            const units = ['B', 'KB', 'MB', 'GB', 'TB'];
            let val = bytes, idx = 0;
            while (val >= 1024 && idx < units.length - 1) { val /= 1024; idx++; }
            return val.toFixed(1) + ' ' + units[idx];
        }
        
        function riskBadge(score) {
            if (score >= 50) return '<span class="risk-badge risk-high">' + score + '</span>';
            if (score >= 25) return '<span class="risk-badge risk-medium">' + score + '</span>';
            if (score > 0) return '<span class="risk-badge risk-low">' + score + '</span>';
            return '<span class="risk-badge risk-none">0</span>';
        }
        
        function applyFilters() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const riskFilter = document.getElementById('riskFilter').value;
            filtered = filesData.filter(f => {
                const risk = f.risk_score || 0;
                if (riskFilter === 'high' && risk < 50) return false;
                if (riskFilter === 'medium' && (risk < 25 || risk >= 50)) return false;
                if (riskFilter === 'low' && (risk <= 0 || risk >= 25)) return false;
                if (riskFilter === 'none' && risk !== 0) return false;
                if (!q) return true;
                const haystack = [f.relative_path||'', f.mime_type||'', f.sha256||'', f.md5||''].join(' ').toLowerCase();
                return haystack.includes(q);
            });
            page = 1;
            render();
        }
        
        function render() {
            const tbody = document.getElementById('filesBody');
            if (!tbody) return;
            const start = (page - 1) * pageSize;
            const end = Math.min(start + pageSize, filtered.length);
            let html = '';
            for (let i = start; i < end; i++) {
                const f = filtered[i];
                const sha = f.sha256 ? (f.sha256.substring(0,16) + '...') : '-';
                const mime = f.mime_type ? (f.mime_type.length > 40 ? f.mime_type.substring(0,40)+'...' : f.mime_type) : '-';
                html += '<tr><td>' + (f.relative_path||f.name||'') + '</td><td>' + formatSize(f.size) + '</td><td class="mime-cell" title="'+(f.mime_type||'')+'">' + mime + '</td><td>' + riskBadge(f.risk_score||0) + '</td><td class="hash-cell">' + sha + '</td><td><button class="view-btn" onclick="showDetails(' + i + ')">View</button></td></tr>';
            }
            tbody.innerHTML = html;
            document.getElementById('resultStats').textContent = filtered.length + ' matching ‚Ä¢ showing ' + (start+1) + '-' + end;
            document.getElementById('pageInfo').textContent = 'Page ' + page + ' / ' + Math.max(1, Math.ceil(filtered.length / pageSize));
        }
        
        function prevPage() { if (page > 1) { page--; render(); } }
        function nextPage() { if (page < Math.ceil(filtered.length / pageSize)) { page++; render(); } }
        
        function showDetails(idx) {
            const f = filtered[idx];
            if (!f) return;
            const panel = document.getElementById('detailPanel');
            const body = document.getElementById('detailBody');
            
            // Helper to create a list from array
            function arrayToList(arr, emptyText) {
                if (!arr || arr.length === 0) return '<span style="color:var(--text-muted);">' + (emptyText||'None') + '</span>';
                return '<ul style="margin:0;padding-left:1.2rem;">' + arr.map(function(item) { return '<li>' + item + '</li>'; }).join('') + '</ul>';
            }
            
            // Basic Info Section
            let html = '<h4 style="margin:0 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">üìÑ File Information</h4>';
            html += '<div class="details-grid">';
            html += '<div class="detail-item"><div class="detail-label">Full Path</div><div class="detail-value" style="word-break:break-all;">' + (f.path||f.relative_path||'') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Size</div><div class="detail-value">' + formatSize(f.size) + ' (' + (f.size||0) + ' bytes)</div></div>';
            html += '<div class="detail-item"><div class="detail-label">MIME Type</div><div class="detail-value">' + (f.mime_type||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">File Type</div><div class="detail-value">' + (f.file_type||f.friendly_type||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Created</div><div class="detail-value">' + (f.created_time||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Modified</div><div class="detail-value">' + (f.modified_time||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Accessed</div><div class="detail-value">' + (f.accessed_time||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Owner</div><div class="detail-value">' + (f.owner||'-') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">Computer</div><div class="detail-value">' + (f.computer||'-') + '</div></div>';
            if (f.archive_path) {
                html += '<div class="detail-item"><div class="detail-label">From Archive</div><div class="detail-value">' + f.archive_path + '</div></div>';
            }
            html += '</div>';
            
            // Risk Assessment Section
            html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">‚ö†Ô∏è Risk Assessment</h4>';
            html += '<div class="details-grid">';
            const riskColor = (f.risk_score||0) >= 70 ? '#e74c3c' : (f.risk_score||0) >= 30 ? '#f39c12' : '#27ae60';
            html += '<div class="detail-item"><div class="detail-label">Risk Score</div><div class="detail-value"><span style="font-weight:bold;font-size:1.2rem;color:' + riskColor + ';">' + (f.risk_score||0) + '</span>/100</div></div>';
            html += '</div>';
            html += '<div class="detail-item" style="margin-top:0.5rem;"><div class="detail-label">Risk Factors</div><div class="detail-value">' + arrayToList(f.risk_reasons, 'No risk factors identified') + '</div></div>';
            
            // Hashes Section
            html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">üîê File Hashes</h4>';
            html += '<div class="details-grid">';
            html += '<div class="detail-item"><div class="detail-label">MD5</div><div class="detail-value" style="font-family:monospace;font-size:0.85rem;">' + (f.md5||'-') + (f.md5 ? ' <button class="copy-btn" onclick="copyHash(\''+f.md5+'\',this)">üìã</button>' : '') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">SHA1</div><div class="detail-value" style="font-family:monospace;font-size:0.85rem;">' + (f.sha1||'-') + (f.sha1 ? ' <button class="copy-btn" onclick="copyHash(\''+f.sha1+'\',this)">üìã</button>' : '') + '</div></div>';
            html += '<div class="detail-item"><div class="detail-label">SHA256</div><div class="detail-value" style="font-family:monospace;font-size:0.85rem;word-break:break-all;">' + (f.sha256||'-') + (f.sha256 ? ' <button class="copy-btn" onclick="copyHash(\''+f.sha256+'\',this)">üìã</button>' : '') + '</div></div>';
            html += '</div>';
            
            // VirusTotal Section (if available)
            if (f.vt_detected !== null || f.vt_link) {
                html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">üõ°Ô∏è VirusTotal Results</h4>';
                html += '<div class="details-grid">';
                if (f.vt_detected === true) {
                    html += '<div class="detail-item"><div class="detail-label">Detection</div><div class="detail-value" style="color:#e74c3c;font-weight:bold;">‚ö†Ô∏è DETECTED - ' + (f.vt_detection_ratio||'') + '</div></div>';
                } else if (f.vt_detected === false) {
                    html += '<div class="detail-item"><div class="detail-label">Detection</div><div class="detail-value" style="color:#27ae60;">‚úì Clean</div></div>';
                }
                if (f.vt_link) {
                    html += '<div class="detail-item"><div class="detail-label">Report</div><div class="detail-value"><a href="' + f.vt_link + '" target="_blank" style="color:var(--primary);">View on VirusTotal ‚Üí</a></div></div>';
                }
                if (f.vt_error) {
                    html += '<div class="detail-item"><div class="detail-label">Error</div><div class="detail-value" style="color:#e74c3c;">' + f.vt_error + '</div></div>';
                }
                html += '</div>';
            }
            
            // Windows Defender Section (if scanned)
            if (f.defender_scanned !== null) {
                html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">üõ°Ô∏è Windows Defender</h4>';
                html += '<div class="details-grid">';
                if (f.defender_detected === true) {
                    html += '<div class="detail-item"><div class="detail-label">Detection</div><div class="detail-value" style="color:#e74c3c;font-weight:bold;">‚ö†Ô∏è THREAT DETECTED</div></div>';
                    if (f.defender_threat_name) {
                        html += '<div class="detail-item"><div class="detail-label">Threat Name</div><div class="detail-value" style="color:#e74c3c;">' + f.defender_threat_name + '</div></div>';
                    }
                } else if (f.defender_scanned === true) {
                    html += '<div class="detail-item"><div class="detail-label">Detection</div><div class="detail-value" style="color:#27ae60;">‚úì Clean</div></div>';
                }
                if (f.defender_error) {
                    html += '<div class="detail-item"><div class="detail-label">Error</div><div class="detail-value" style="color:#e74c3c;">' + f.defender_error + '</div></div>';
                }
                html += '</div>';
            }
            
            // PE/Executable Analysis Section
            const hasExeAnalysis = (f.exe_domains && f.exe_domains.length) || (f.exe_ips && f.exe_ips.length) || (f.exe_urls && f.exe_urls.length) || (f.exe_suspicious_imports && f.exe_suspicious_imports.length) || f.exe_company || f.is_signed !== null;
            if (hasExeAnalysis) {
                html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">‚öôÔ∏è Executable Analysis</h4>';
                
                // PE Metadata
                if (f.exe_company || f.exe_product || f.exe_description || f.exe_version) {
                    html += '<div class="details-grid">';
                    if (f.exe_company) html += '<div class="detail-item"><div class="detail-label">Company</div><div class="detail-value">' + f.exe_company + '</div></div>';
                    if (f.exe_product) html += '<div class="detail-item"><div class="detail-label">Product</div><div class="detail-value">' + f.exe_product + '</div></div>';
                    if (f.exe_description) html += '<div class="detail-item"><div class="detail-label">Description</div><div class="detail-value">' + f.exe_description + '</div></div>';
                    if (f.exe_version) html += '<div class="detail-item"><div class="detail-label">Version</div><div class="detail-value">' + f.exe_version + '</div></div>';
                    html += '</div>';
                }
                
                // Digital Signature
                html += '<div class="details-grid" style="margin-top:0.5rem;">';
                if (f.is_signed === true) {
                    html += '<div class="detail-item"><div class="detail-label">Digital Signature</div><div class="detail-value" style="color:#27ae60;">‚úì Signed</div></div>';
                    if (f.sig_subject) html += '<div class="detail-item"><div class="detail-label">Signer</div><div class="detail-value">' + f.sig_subject + '</div></div>';
                    if (f.sig_issuer) html += '<div class="detail-item"><div class="detail-label">Issuer</div><div class="detail-value">' + f.sig_issuer + '</div></div>';
                } else if (f.is_signed === false) {
                    html += '<div class="detail-item"><div class="detail-label">Digital Signature</div><div class="detail-value" style="color:#f39c12;">‚úó Not Signed</div></div>';
                }
                html += '</div>';
                
                // IOCs - Network Indicators
                html += '<div style="margin-top:1rem;"><div class="detail-label" style="margin-bottom:0.5rem;">üåê Network IOCs (Domains)</div><div class="detail-value">' + arrayToList(f.exe_domains, 'None found') + '</div></div>';
                html += '<div style="margin-top:0.75rem;"><div class="detail-label" style="margin-bottom:0.5rem;">üìç Network IOCs (IP Addresses)</div><div class="detail-value">' + arrayToList(f.exe_ips, 'None found') + '</div></div>';
                html += '<div style="margin-top:0.75rem;"><div class="detail-label" style="margin-bottom:0.5rem;">üîó Network IOCs (URLs)</div><div class="detail-value">' + arrayToList(f.exe_urls, 'None found') + '</div></div>';
                
                // Suspicious Imports
                html += '<div style="margin-top:0.75rem;"><div class="detail-label" style="margin-bottom:0.5rem;">üö® Suspicious API Imports</div><div class="detail-value">' + arrayToList(f.exe_suspicious_imports, 'None found') + '</div></div>';
                
                if (f.exe_analysis_error) {
                    html += '<div style="margin-top:0.75rem;"><div class="detail-label">Analysis Error</div><div class="detail-value" style="color:#e74c3c;">' + f.exe_analysis_error + '</div></div>';
                }
            }
            
            // Document Analysis Section (PDF, Office)
            const hasDocAnalysis = f.doc_has_macros !== null || f.doc_has_javascript !== null || (f.doc_suspicious_elements && f.doc_suspicious_elements.length) || f.doc_author;
            if (hasDocAnalysis) {
                html += '<h4 style="margin:1.5rem 0 1rem 0;color:var(--text-muted);border-bottom:1px solid var(--border);padding-bottom:0.5rem;">üìë Document Analysis</h4>';
                
                // Security Indicators
                html += '<div class="details-grid">';
                if (f.doc_has_macros !== null) {
                    const macroStyle = f.doc_has_macros ? 'color:#e74c3c;font-weight:bold;' : 'color:#27ae60;';
                    html += '<div class="detail-item"><div class="detail-label">VBA Macros</div><div class="detail-value" style="' + macroStyle + '">' + (f.doc_has_macros ? '‚ö†Ô∏è PRESENT' : '‚úì None') + '</div></div>';
                }
                if (f.doc_has_javascript !== null) {
                    const jsStyle = f.doc_has_javascript ? 'color:#e74c3c;font-weight:bold;' : 'color:#27ae60;';
                    html += '<div class="detail-item"><div class="detail-label">JavaScript</div><div class="detail-value" style="' + jsStyle + '">' + (f.doc_has_javascript ? '‚ö†Ô∏è PRESENT' : '‚úì None') + '</div></div>';
                }
                html += '</div>';
                
                // Suspicious Elements
                if (f.doc_suspicious_elements && f.doc_suspicious_elements.length) {
                    html += '<div style="margin-top:0.75rem;"><div class="detail-label" style="margin-bottom:0.5rem;color:#e74c3c;">üö® Suspicious Elements</div><div class="detail-value">' + arrayToList(f.doc_suspicious_elements) + '</div></div>';
                }
                
                // Document Properties
                if (f.doc_author || f.doc_company || f.doc_title || f.doc_last_modified_by) {
                    html += '<div style="margin-top:1rem;"><div class="detail-label" style="margin-bottom:0.5rem;">Document Properties</div></div>';
                    html += '<div class="details-grid">';
                    if (f.doc_author) html += '<div class="detail-item"><div class="detail-label">Author</div><div class="detail-value">' + f.doc_author + '</div></div>';
                    if (f.doc_last_modified_by) html += '<div class="detail-item"><div class="detail-label">Last Modified By</div><div class="detail-value">' + f.doc_last_modified_by + '</div></div>';
                    if (f.doc_company) html += '<div class="detail-item"><div class="detail-label">Company</div><div class="detail-value">' + f.doc_company + '</div></div>';
                    if (f.doc_title) html += '<div class="detail-item"><div class="detail-label">Title</div><div class="detail-value">' + f.doc_title + '</div></div>';
                    if (f.doc_subject) html += '<div class="detail-item"><div class="detail-label">Subject</div><div class="detail-value">' + f.doc_subject + '</div></div>';
                    if (f.doc_keywords) html += '<div class="detail-item"><div class="detail-label">Keywords</div><div class="detail-value">' + f.doc_keywords + '</div></div>';
                    if (f.doc_created) html += '<div class="detail-item"><div class="detail-label">Doc Created</div><div class="detail-value">' + f.doc_created + '</div></div>';
                    if (f.doc_modified) html += '<div class="detail-item"><div class="detail-label">Doc Modified</div><div class="detail-value">' + f.doc_modified + '</div></div>';
                    html += '</div>';
                }
                
                if (f.doc_analysis_error) {
                    html += '<div style="margin-top:0.75rem;"><div class="detail-label">Analysis Error</div><div class="detail-value" style="color:#e74c3c;">' + f.doc_analysis_error + '</div></div>';
                }
            }
            
            body.innerHTML = html;
            panel.style.display = 'block';
        }
        function closeDetails() { document.getElementById('detailPanel').style.display = 'none'; }
        
        // ==========================================
        // IOC Table with Pagination
        // ==========================================
        const iocData = [];
        // Build IOC data from files
        filesData.forEach(function(f) {
            if (f.exe_domains && f.exe_domains.length) {
                f.exe_domains.forEach(function(d) {
                    iocData.push({type: 'domain', value: d, source: f.relative_path || f.name});
                });
            }
            if (f.exe_ips && f.exe_ips.length) {
                f.exe_ips.forEach(function(ip) {
                    iocData.push({type: 'ip', value: ip, source: f.relative_path || f.name});
                });
            }
        });
        
        let iocFiltered = iocData.slice();
        let iocPage = 1;
        const iocPageSize = 50;
        
        function filterIOCs() {
            const search = (document.getElementById('iocSearch').value || '').toLowerCase();
            const typeFilter = document.getElementById('iocTypeFilter').value;
            
            iocFiltered = iocData.filter(function(ioc) {
                const matchesSearch = !search || ioc.value.toLowerCase().includes(search) || ioc.source.toLowerCase().includes(search);
                const matchesType = typeFilter === 'all' || ioc.type === typeFilter;
                return matchesSearch && matchesType;
            });
            iocPage = 1;
            renderIOCs();
        }
        
        function renderIOCs() {
            const tbody = document.getElementById('iocBody');
            if (!tbody) return;
            
            const start = (iocPage - 1) * iocPageSize;
            const end = Math.min(start + iocPageSize, iocFiltered.length);
            
            let html = '';
            for (let i = start; i < end; i++) {
                const ioc = iocFiltered[i];
                const typeLabel = ioc.type === 'domain' ? '<span class="tag network">Domain</span>' : '<span class="tag suspicious">IP</span>';
                html += '<tr><td>' + typeLabel + '</td><td style="font-family:monospace;">' + ioc.value + '</td><td>' + ioc.source + '</td></tr>';
            }
            tbody.innerHTML = html || '<tr><td colspan="3" style="text-align:center;color:var(--text-muted);">No IOCs found</td></tr>';
            
            document.getElementById('iocStats').textContent = iocFiltered.length + ' IOCs';
            document.getElementById('iocPageInfo').textContent = iocFiltered.length > 0 ? 
                'Page ' + iocPage + ' / ' + Math.max(1, Math.ceil(iocFiltered.length / iocPageSize)) : '';
        }
        
        function iocPrevPage() { if (iocPage > 1) { iocPage--; renderIOCs(); } }
        function iocNextPage() { if (iocPage < Math.ceil(iocFiltered.length / iocPageSize)) { iocPage++; renderIOCs(); } }
        
        // IOC event listeners
        if (document.getElementById('iocSearch')) {
            document.getElementById('iocSearch').addEventListener('input', function() {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(filterIOCs, 200);
            });
            document.getElementById('iocTypeFilter').addEventListener('change', filterIOCs);
            // Initial IOC render
            renderIOCs();
        }
        
        // Event listeners with debounce
        document.getElementById('searchInput').addEventListener('input', function() {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(applyFilters, 200);
        });
        document.getElementById('riskFilter').addEventListener('change', applyFilters);
        document.getElementById('pageSize').addEventListener('change', function() {
            pageSize = parseInt(this.value, 10) || 250;
            page = 1;
            render();
        });
        
        // Initial render
        applyFilters();
    </script>
</body>
</html>